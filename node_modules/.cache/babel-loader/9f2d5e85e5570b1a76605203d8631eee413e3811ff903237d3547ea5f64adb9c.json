{"ast":null,"code":"var _jsxFileName = \"/Users/user/Documents/DUY IT/S0002/news002/news002/src/router/ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { matchPath } from 'react-router-dom';\nimport CustomRoute from './CustomRoute';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ProtectedRoute = _ref => {\n  _s();\n  let {\n    fallback,\n    route,\n    guards,\n    ...rest\n  } = _ref;\n  const [canAccess, setCanAccess] = useState(true);\n  useEffect(() => {\n    checkAsync();\n  }, []);\n  const checkAsync = async () => {\n    const {\n      pathname\n    } = window.location;\n    const matchResult = matchPath(pathname, rest);\n    const hasMatchedRoute = !!matchResult;\n    if (hasMatchedRoute) {\n      var _route$guards;\n      const guardArgs = rest;\n      // const canBeRendered = await route?.guards?.every(async (guard) => await guard(guardArgs));\n      const canBeRendered = await asyncEvery(route === null || route === void 0 ? void 0 : route.guards, async guard => await guard(guardArgs, route));\n      if (route !== null && route !== void 0 && (_route$guards = route.guards) !== null && _route$guards !== void 0 && _route$guards.length && !canBeRendered) {\n        setCanAccess(false);\n      } else {\n        setCanAccess(true);\n      }\n    }\n  };\n  if (!canAccess) {\n    const fallbackArgs = rest;\n    return route === null || route === void 0 ? void 0 : route.fallback(fallbackArgs);\n  }\n  const asyncEvery = async (arr, predicate) => {\n    for (let e of arr) {\n      if (!(await predicate(e))) {\n        return false;\n      }\n    }\n    return true;\n  };\n  return /*#__PURE__*/_jsxDEV(CustomRoute, {\n    path: route.path,\n    exact: true,\n    Layout: route.layout,\n    route: route,\n    children: route.component\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 9\n  }, this);\n};\n_s(ProtectedRoute, \"765dXLU0wNMeFf2s8N0tIw6R91o=\");\n_c = ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["useEffect","useState","matchPath","CustomRoute","jsxDEV","_jsxDEV","ProtectedRoute","_ref","_s","fallback","route","guards","rest","canAccess","setCanAccess","checkAsync","pathname","window","location","matchResult","hasMatchedRoute","_route$guards","guardArgs","canBeRendered","asyncEvery","guard","length","fallbackArgs","arr","predicate","e","path","exact","Layout","layout","children","component","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/user/Documents/DUY IT/S0002/news002/news002/src/router/ProtectedRoute.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport\r\n{\r\n    matchPath\r\n} from 'react-router-dom';\r\nimport CustomRoute from './CustomRoute';\r\n\r\nexport const ProtectedRoute = ({\r\n    fallback,\r\n    route,\r\n    guards,\r\n    ...rest\r\n}) =>\r\n{\r\n\r\n    const [canAccess, setCanAccess] = useState(true)\r\n    useEffect(() =>\r\n    {\r\n        checkAsync()\r\n    }, [])\r\n\r\n    const checkAsync = async () =>\r\n    {\r\n        const {\r\n            pathname,\r\n        } = window.location;\r\n        const matchResult = matchPath(pathname, rest);\r\n        const hasMatchedRoute = !!matchResult;\r\n        if (hasMatchedRoute) {\r\n            const guardArgs = rest;\r\n            // const canBeRendered = await route?.guards?.every(async (guard) => await guard(guardArgs));\r\n            const canBeRendered = await asyncEvery(route?.guards, async (guard) => await guard(guardArgs, route));\r\n            if (route?.guards?.length && !canBeRendered) {\r\n                setCanAccess(false)\r\n            } else {\r\n                setCanAccess(true)\r\n            }\r\n        }\r\n    }\r\n    if (!canAccess) {\r\n        const fallbackArgs = rest;\r\n        return route?.fallback(fallbackArgs);\r\n    }\r\n    const asyncEvery = async (arr, predicate) =>\r\n    {\r\n        for (let e of arr) {\r\n            if (!(await predicate(e))) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n\r\n    return (\r\n        <CustomRoute path={route.path} exact Layout={route.layout} route={route} >\r\n            {route.component}\r\n        </CustomRoute >\r\n    );\r\n};"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAEIC,SAAS,QACN,kBAAkB;AACzB,OAAOC,WAAW,MAAM,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,OAAO,MAAMC,cAAc,GAAGC,IAAA,IAM9B;EAAAC,EAAA;EAAA,IAN+B;IAC3BC,QAAQ;IACRC,KAAK;IACLC,MAAM;IACN,GAAGC;EACP,CAAC,GAAAL,IAAA;EAGG,MAAM,CAACM,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAChDD,SAAS,CAAC,MACV;IACIe,UAAU,CAAC,CAAC;EAChB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMA,UAAU,GAAG,MAAAA,CAAA,KACnB;IACI,MAAM;MACFC;IACJ,CAAC,GAAGC,MAAM,CAACC,QAAQ;IACnB,MAAMC,WAAW,GAAGjB,SAAS,CAACc,QAAQ,EAAEJ,IAAI,CAAC;IAC7C,MAAMQ,eAAe,GAAG,CAAC,CAACD,WAAW;IACrC,IAAIC,eAAe,EAAE;MAAA,IAAAC,aAAA;MACjB,MAAMC,SAAS,GAAGV,IAAI;MACtB;MACA,MAAMW,aAAa,GAAG,MAAMC,UAAU,CAACd,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEC,MAAM,EAAE,MAAOc,KAAK,IAAK,MAAMA,KAAK,CAACH,SAAS,EAAEZ,KAAK,CAAC,CAAC;MACrG,IAAIA,KAAK,aAALA,KAAK,gBAAAW,aAAA,GAALX,KAAK,CAAEC,MAAM,cAAAU,aAAA,eAAbA,aAAA,CAAeK,MAAM,IAAI,CAACH,aAAa,EAAE;QACzCT,YAAY,CAAC,KAAK,CAAC;MACvB,CAAC,MAAM;QACHA,YAAY,CAAC,IAAI,CAAC;MACtB;IACJ;EACJ,CAAC;EACD,IAAI,CAACD,SAAS,EAAE;IACZ,MAAMc,YAAY,GAAGf,IAAI;IACzB,OAAOF,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAED,QAAQ,CAACkB,YAAY,CAAC;EACxC;EACA,MAAMH,UAAU,GAAG,MAAAA,CAAOI,GAAG,EAAEC,SAAS,KACxC;IACI,KAAK,IAAIC,CAAC,IAAIF,GAAG,EAAE;MACf,IAAI,EAAE,MAAMC,SAAS,CAACC,CAAC,CAAC,CAAC,EAAE;QACvB,OAAO,KAAK;MAChB;IACJ;IACA,OAAO,IAAI;EACf,CAAC;EAED,oBACIzB,OAAA,CAACF,WAAW;IAAC4B,IAAI,EAAErB,KAAK,CAACqB,IAAK;IAACC,KAAK;IAACC,MAAM,EAAEvB,KAAK,CAACwB,MAAO;IAACxB,KAAK,EAAEA,KAAM;IAAAyB,QAAA,EACnEzB,KAAK,CAAC0B;EAAS;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACN,CAAC;AAEvB,CAAC;AAAChC,EAAA,CAnDWF,cAAc;AAAAmC,EAAA,GAAdnC,cAAc;AAAA,IAAAmC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}